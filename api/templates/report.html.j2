<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <title>{{ summary_title or '年度报告比对' }}</title>
  <style>
    body { font-family: 'Noto Sans SC', sans-serif; margin: 24px; }
    h1 { font-size: 24px; }
    table { border-collapse: collapse; width: 100%; margin-bottom: 16px; }
    th, td { border: 1px solid #ccc; padding: 4px 8px; }
    .diff-added { background: #e8f5e9; }
    .diff-removed { background: #ffebee; }
    .diff-changed { background: #fff8e1; }
  </style>
</head>
<body>
  <h1>{{ summary_title or '年度报告比对' }}</h1>
  <section>
    <h2>复用率概览</h2>
    <p>文本复用率：{{ text_reuse | default('N/A') }}</p>
    <p>表格复用率：{{ table_reuse | default('N/A') }}</p>
  </section>
  <section>
    <h2>勾稽校验</h2>
    <ul>
      {% for check in checks %}
      <li>{{ check }}</li>
      {% endfor %}
    </ul>
  </section>
  <section>
    <h2>句级对照</h2>
    {% for pair in text_pairs %}
      <article>
        <p><strong>往年：</strong>{{ pair.left }}</p>
        <p><strong>当年：</strong>{{ pair.right }}</p>
        <p>相似度：{{ '%.2f'|format(pair.score) }}</p>
      </article>
    {% endfor %}
  </section>
  <section>
    <h2>表格差异</h2>
    {% for key, table in tables.items() %}
      <h3>{{ key }}</h3>
      <table>
        <thead>
          <tr><th>指标</th><th>上一年</th><th>当年</th><th>变化</th></tr>
        </thead>
        <tbody>
          {% for cell in table.cells %}
          <tr class="{{ 'diff-changed' if cell.changed else '' }}">
            <td>{{ cell.path_key }}</td>
            <td>{{ cell.left }}</td>
            <td>{{ cell.right }}</td>
            <td>{{ '变化' if cell.changed else '相同' }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% endfor %}
  </section>
</body>
</html>
